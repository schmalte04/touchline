<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Betting Assistant</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Password Protection Overlay -->
    <div id="passwordOverlay" class="password-overlay">
        <div class="password-container">
            <div class="password-header">
                <h2>üîê Access Required</h2>
                <p>Please enter the password to access Touchline Betting Assistant</p>
            </div>
            <div class="password-form">
                <input type="password" id="passwordInput" placeholder="Enter password..." autocomplete="off">
                <button id="passwordSubmit">Enter</button>
                <div id="passwordError" class="password-error" style="display: none;">
                    ‚ùå Incorrect password. Please try again.
                </div>
            </div>
        </div>
    </div>

    <div class="container" id="mainContent" style="display: none;">
        <header>
            <h1>üéØ Touchline Betting Assistant</h1>
            <p>AI-powered accumulator betting with advanced match analysis</p>
        </header>

        <div class="chat-container">
            <div class="chat-header">
                <h2>üí¨ Claude Betting Assistant</h2>
                <div class="status-indicator">
                    <span class="status-dot online"></span>
                    <span>Online</span>
                </div>
            </div>

            <div class="chat-messages" id="chatMessages">
                <div class="message bot-message">
                    <div class="message-avatar">ü§ñ</div>
                    <div class="message-content">
                        <p>ÔøΩ Connecting to Claude AI...</p>
                    </div>
                </div>
            </div>

            <div class="chat-input-container">
                <div class="typing-indicator" id="typingIndicator" style="display: none;">
                    <span></span>
                    <span></span>
                    <span></span>
                    Claude is analyzing...
                </div>
                <div class="input-group">
                    <input type="text" id="chatInput" placeholder="Type your message here..." />
                    <button id="sendButton">Send</button>
                </div>
            </div>
        </div>

        <div class="quick-actions">
            <h3>Quick Actions</h3>
            <div class="action-buttons">
                <button class="action-btn" onclick="quickAction('upcoming_matches')">
                    üìÖ Show Interesting Upcoming Matches
                </button>
                <button class="action-btn" onclick="quickAction('high_confidence')">
                    ‚≠ê High Confidence Bets
                </button>
                <button class="action-btn" onclick="quickAction('build_accumulator')">
                    üé≤ Build Accumulator
                </button>
                <button class="action-btn" onclick="quickAction('analyze_match')">
                    üî¨ Analyze Specific Match
                </button>
            </div>
        </div>

        <div class="betting-workspace" id="bettingWorkspace" style="display: none;">
            <h3>üéØ Accumulator Builder</h3>
            <div class="accumulator-summary">
                <div class="bet-list" id="betList">
                    <!-- Bets will be added here dynamically -->
                </div>
                <div class="accumulator-stats">
                    <div class="stat">
                        <label>Number of Bets:</label>
                        <span id="numBets">0</span>
                    </div>
                    <div class="stat">
                        <label>Total Odds:</label>
                        <span id="totalOdds">1.00</span>
                    </div>
                    <div class="stat">
                        <label>Confidence Score:</label>
                        <span id="confidenceScore">0%</span>
                    </div>
                    <div class="stat">
                        <label>Potential Win:</label>
                        <span id="potentialWin">¬£0.00</span>
                    </div>
                </div>
                <div class="stake-input">
                    <label for="stakeInput">Stake Amount (¬£):</label>
                    <input type="number" id="stakeInput" value="10" min="1" step="0.01">
                </div>
            </div>
        </div>
    </div>

        <script src="script-claude.js?v=20250811d"></script>
        <script>
            // Password protection system
            document.addEventListener('DOMContentLoaded', function() {
                const passwordOverlay = document.getElementById('passwordOverlay');
                const mainContent = document.getElementById('mainContent');
                const passwordInput = document.getElementById('passwordInput');
                const passwordSubmit = document.getElementById('passwordSubmit');
                const passwordError = document.getElementById('passwordError');
                
                // Check if user is already authenticated (for development)
                const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
                if (isLocalhost) {
                    // Skip password on localhost for development
                    showMainContent();
                    return;
                }
                
                // Check session storage for authentication
                if (sessionStorage.getItem('authenticated') === 'true') {
                    showMainContent();
                    return;
                }
                
                async function checkPassword() {
                    const enteredPassword = passwordInput.value.trim();
                    if (!enteredPassword) {
                        passwordError.textContent = '‚ùå Please enter a password';
                        passwordError.style.display = 'block';
                        return;
                    }
                    
                    try {
                        passwordSubmit.disabled = true;
                        passwordSubmit.textContent = 'Checking...';
                        
                        const response = await fetch('/api/validate-password', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ password: enteredPassword })
                        });
                        
                        const data = await response.json();
                        
                        if (data.success) {
                            sessionStorage.setItem('authenticated', 'true');
                            showMainContent();
                        } else {
                            passwordError.textContent = '‚ùå Incorrect password. Please try again.';
                            passwordError.style.display = 'block';
                            passwordInput.value = '';
                            passwordInput.focus();
                        }
                    } catch (error) {
                        console.error('Password validation error:', error);
                        passwordError.textContent = '‚ùå Connection error. Please try again.';
                        passwordError.style.display = 'block';
                    } finally {
                        passwordSubmit.disabled = false;
                        passwordSubmit.textContent = 'Enter';
                    }
                }
                
                function showMainContent() {
                    passwordOverlay.style.display = 'none';
                    mainContent.style.display = 'block';
                }
                
                passwordSubmit.addEventListener('click', checkPassword);
                passwordInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        checkPassword();
                    }
                });
                
                // Focus on password input
                passwordInput.focus();
            });
        </script>
</body>
</html>
